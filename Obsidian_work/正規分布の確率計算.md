#ChatGPT #確率 #Python 

```
質問：
正規分布を想定したときに、
1σの区間に入る確率は68.27%
2σの区間に入る確率は95.45%
3σの区間に入る確率は99.73%
…であることを知りました。
具体的に確率を算出するための計算式を教えてください。
```

はい、正規分布における±1σ、±2σ、±3σの区間に含まれる確率（いわゆる **68-95-99.7ルール**）は、**標準正規分布（平均0、標準偏差1）**に基づく積分によって求められます。

---

## 🔢 基本式

正規分布における確率密度関数（PDF）は以下の式です：

f(x)=12πe−x22f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}

これは**標準正規分布**（平均μ=0、標準偏差σ=1）の関数です。

---

## ✅ 区間に入る確率を求める式

区間 [−a,a][-a, a] に入る確率は、累積分布関数（CDF）Φ(x)\Phi(x) を用いて以下のように表されます：

P(−a≤X≤a)=Φ(a)−Φ(−a)P(-a \leq X \leq a) = \Phi(a) - \Phi(-a)

標準正規分布では、Φ(−a)=1−Φ(a)\Phi(-a) = 1 - \Phi(a) なので：

P(−a≤X≤a)=2Φ(a)−1P(-a \leq X \leq a) = 2\Phi(a) - 1

これを使って、a = 1, 2, 3 のときの確率を計算できます。

---

## 🎯 具体的な値（a = σ）

|範囲 (±aσ)|Φ(a) (片側累積)|P(-a ≤ X ≤ a) = 2Φ(a) - 1|
|---|---|---|
|±1σ|≒ 0.8413|≒ 2×0.8413 − 1 = 0.6826（68.26%）|
|±2σ|≒ 0.9772|≒ 2×0.9772 − 1 = 0.9544（95.44%）|
|±3σ|≒ 0.9987|≒ 2×0.9987 − 1 = 0.9974（99.74%）|

---

## 🧮 実際の計算（プログラム的には）

例えば Python（SciPy）では以下のように求められます：

```python
from scipy.stats import norm

# ±1σの区間に入る確率
p1 = norm.cdf(1) - norm.cdf(-1)  # ≈ 0.6827

# ±2σ
p2 = norm.cdf(2) - norm.cdf(-2)  # ≈ 0.9545

# ±3σ
p3 = norm.cdf(3) - norm.cdf(-3)  # ≈ 0.9973
```

---

## ✏️ 補足：Φ(x) を手計算するには？

Φ(x)=12π∫−∞xe−t22dt\Phi(x) = \frac{1}{\sqrt{2\pi}} \int_{-\infty}^{x} e^{-\frac{t^2}{2}} dt

これは解析的に積分できないため、通常は数値積分、統計表、またはプログラムで求めます。

---

ご希望があれば、特定のσ区間に入る確率を手元で計算してお示しすることも可能です。お気軽にどうぞ。